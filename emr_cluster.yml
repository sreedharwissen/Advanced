---
AWSTemplateFormatVersion: '2010-09-09'
Parameters:
  InstanceType:
    Type: String
  ReleaseLabel:
    Type: String
  SubnetId:
    Type: String
  MinimumCapacityUnits:
    Type: String
  MaximumCapacityUnits:
    Type: String
  MaximumCoreCapacityUnits:
    Type: String
  MaximumOnDemandCapacityUnits:
    Type: String
  UnitType:
    Type: String
Resources:
  cluster:
    Type: AWS::EMR::Cluster
    Properties:
      Instances:
        MasterInstanceGroup:
          InstanceCount: 1
          InstanceType:
            Ref: InstanceType
          Market: ON_DEMAND
          Name: primary
        CoreInstanceGroup:
          InstanceCount: 1
          InstanceType:
            Ref: InstanceType
          Market: ON_DEMAND
          Name: core
        TaskInstanceGroups:
        - InstanceCount: 1
          InstanceType:
            Ref: InstanceType
          Market: ON_DEMAND
          Name: cfnTask-1
        - InstanceCount: 1
          InstanceType:
            Ref: InstanceType
          Market: ON_DEMAND
          Name: cfnTask-2
        Ec2SubnetId:
          Ref: SubnetId
      Name: ManagedScalingExample
      JobFlowRole: EMR_EC2_DefaultRole
      ServiceRole: EMR_DefaultRole
      ReleaseLabel:
        Ref: ReleaseLabel
      ManagedScalingPolicy:
        ComputeLimits:
          MinimumCapacityUnits:
            Ref: MinimumCapacityUnits
          MaximumCapacityUnits:
            Ref: MaximumCapacityUnits
          MaximumCoreCapacityUnits:
            Ref: MaximumCoreCapacityUnits
          MaximumOnDemandCapacityUnits:
            Ref: MaximumOnDemandCapacityUnits
          UnitType:
            Ref: UnitType
